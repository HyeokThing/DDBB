<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" data-bs-theme="auto">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <title>비밀번호 찾기 페이지</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-aFq/bzH65dt+w6FI2ooMVUpc+21e0SRygnTpmBvdBgSdnuTN7QbdgL+OapgHtvPp" crossorigin="anonymous">
    <link href="/css/sign_in.css" rel="stylesheet">
</head>
<body class="text-center">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/js/bootstrap.bundle.min.js" integrity="sha384-qKXV1j0HvMUeCBQ+QVp7JcfGl760yU08IQ+GpUo5hlbpg51QRiuqHAJz8+BrxE/N" crossorigin="anonymous"></script>
<main class="form-signin w-100 m-auto">
        <img class="mb-4" src="img/Car.jpg" alt="" width="72" height="57">
        <h1 class="h3 mb-3 fw-normal">Please write down your ID, Nicknames, Email</h1>
    <form th:action="@{/signFindPassword}" method="post">
        <div class="form-floating">
            <input type="text" name="id" class="form-control" id="floatingInput">
            <label for="floatingInput">ID</label>
        </div>

        <div class="form-floating">
            <input type="text" name="nickname" class="form-control" id="floatingInputs">
            <label for="floatingInput">Nickname</label>
        </div>

        <div class="form-floating">
            <input type="text" name="email" class="form-control" id="email">
            <label for="floatingInput">이메일</label>
        </div>
        <p>
        </p>
        <button id="findpassword" class="w-100 btn btn-lg btn-primary" type="submit">비밀번호 찾기</button>
    </form>
        <script>
            function showAlert() {
                // 사용자가 입력한 성함과 이메일 주소를 가져옵니다.
                const name = document.getElementById("id").value;
                const email = document.getElementById("Nickname").value;

                // Ajax를 사용하여 db에서 데이터를 가져옵니다.
                const xhr = new XMLHttpRequest();
                xhr.open("POST", "/find_password", true);
                xhr.setRequestHeader("Content-Type", "application/json");
                xhr.onreadystatechange = function() {
                    if (xhr.readyState === 4 && xhr.status === 200) {
                        const response = JSON.parse(xhr.responseText);
                        // db에서 데이터를 찾은 후, 성함과 이메일 주소가 일치하는 데이터가 있는지 확인합니다.
                        const matchedData = response.find(data => data.name === name && data.email === email);
                        if (matchedData) {
                            // 일치하는 데이터가 있다면, 성함과 이메일 주소를 alert 창에 띄웁니다.
                            alert(`찾으시는 비밀번호는 ${matchedData.password}입니다.`);
                        } else {
                            // 일치하는 데이터가 없다면, 사용자에게 알립니다.
                            alert("일치하는 비밀번호를 찾을 수 없습니다.");
                        }
                    }
                };
                xhr.send(JSON.stringify({ id: this.id, Nickname: this.Nickname }));
            }
        </script>

        <p></p>




</main>
</body>
</html>